var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,a){function o(t){try{u(r.next(t))}catch(e){a(e)}}function s(t){try{u(r["throw"](t))}catch(e){a(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,s)}u((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,a&&(o=a[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,a=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(o=u.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){u.label=n[1];break}if(6===n[0]&&u.label<o[1]){u.label=o[1],o=n;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(n);break}o[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(r){n=[6,r],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__assign=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;r>n;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},adapter;!function(t){var e=(window.performance?function(){return window.performance.now()}:function(){return Date.now()},function(){function e(t){var e=this;this.target=t,this.actions=[],this.index=0,this.loopJump=-1,this.duration=0,this.speedRate=1;var n=new Promise(function(t){return e.resolve=t});this.then=n.then.bind(n)}return e.get=function(t,n){return n&&e.removeTweens(t),new e(t||{})},e.removeTweens=function(t){for(var e=0;e<this.tweens.length;e++){var n=this.tweens[e];n.target==t&&(n.stop(),this.tweens.splice(e--,1))}},e.prototype.setSpeedRate=function(t){this.speedRate=t,0>=t&&(this.speedRate=1)},e.addTween=function(n){e.tweens.push(n),e.frameCallId>=0||(e.frameCallId=t.Scheduler.frameCall(function(n){for(var r=e.tweens,i=0;i<r.length;i++){var a=Math.min(n,e.MaxFrameTime)*r[i].speedRate,o=r[i];o.resolve?o.update(a):r.splice(i--,1)}0==r.length&&(t.Scheduler.cancelFrameCall(e.frameCallId),e.frameCallId=-1)},this,-1))},e.prototype.stop=function(){this.resolve=null,this.actions.length=0},e.prototype.pause=function(){this.paused=!0},e.prototype.resume=function(){this.paused&&(this.paused=!1)},e.prototype.wait=function(t){return this.addAction({type:3,duration:t})},e.prototype.set=function(t){return this.addAction({type:2,duration:0,prop:t})},e.prototype.to=function(t,e,n){return void 0===e&&(e=0),this.addAction({type:0,duration:e,ease:n,prop:t})},e.prototype.by=function(t,e,n){return void 0===e&&(e=0),this.addAction({type:1,duration:e,ease:n,prop:t})},e.prototype.loop=function(t){void 0===t&&(t=0);var e=this.loopJump;return this.actions.length-e<=1?this:(this.loopJump=this.actions.length,t=t>0?t:1/0,this.addAction({type:4,duration:0,times:t,jump:e}))},e.prototype.onChange=function(t){return this.callback=t,this},e.prototype.addAction=function(t){return this.resolve?(this.actions.push(t),1==this.actions.length&&(this.onActionStart(),e.addTween(this)),this):new e(this.target).addAction(t)},e.prototype.onActionStart=function(){var t=this.actions[this.index],e=t.type,n=t.start;if(1==e||0==e&&!n)for(var r=this.target,i=n||(t.start={}),a=0,o=Object.keys(t.prop);a<o.length;a++){var s=o[a];i[s]=r[s]}},e.prototype.onActionDone=function(){return++this.index<this.actions.length?this.onActionStart():(this.resolve(),this.resolve=null,void(this.actions.length=0))},e.prototype.doAction=function(t){var e=this.actions[this.index],n=e.duration,r=Math.min(t,n-this.duration),i=n?(this.duration+=r)/n:1;switch(e.type){case 0:for(var a=e.ease,o=e.prop,s=e.start,u=a?a(i):i,c=0,l=Object.keys(o);c<l.length;c++){var h=l[c],d=s[h];this.target[h]=d+(o[h]-d)*u}this.callback&&this.callback(this.target);break;case 1:for(var a=e.ease,o=e.prop,s=e.start,u=a?a(i):i,p=0,f=Object.keys(o);p<f.length;p++){var h=f[p];this.target[h]=s[h]+o[h]*u}this.callback&&this.callback(this.target);break;case 2:for(var a=e.ease,o=e.prop,m=0,g=Object.keys(o);m<g.length;m++){var h=g[m];this.target[h]=o[h]}this.callback&&this.callback(this.target);break;case 4:--e.times>0&&(this.index=e.jump)}return this.duration>=n&&(this.duration=0,this.onActionDone()),t-r},e.prototype.update=function(t){if(!this.paused)for(;t>0&&this.resolve;)t=this.doAction(t)},e.MaxFrameTime=3e3,e.tweens=[],e.frameCallId=-1,e}());t.Tween=e,__reflect(e.prototype,"adapter.Tween",["PromiseLike"]),t.tween=e.get}(adapter||(adapter={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function r(r){e.call(n,r,t)}if(RES.hasRes(t)){var i=RES.getRes(t);i?r(i):RES.getResAsync(t,r,this)}else RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="loading",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){this.loadBar.width=0},e.prototype.onProgress=function(t,e){this.loadBar.width=t/e*493},e}(eui.Component);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.error(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return adapter.UIWindow.getInstance().init(this,new egret.Rectangle(0,0,this.stage.stageWidth,this.stage.stageHeight)),[4,this.loadResource()];case 1:return t.sent(),this.gotoGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("loading")];case 3:return n.sent(),t=new LoadingUI,adapter.UIWindow.getInstance().addView(t),[4,RES.loadGroup("preload",0,t)];case 4:return n.sent(),adapter.UIWindow.getInstance().removeView(t),[3,6];case 5:return e=n.sent(),console.error(e),[3,6];case 6:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var r=new eui.Theme("resource/default.thm.json",t.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.gotoGameScene=function(){GameMainController.getInstance().showMainView()},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,r){function i(t){e.call(r,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),n.call(r))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(r,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var u=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(r,generateJSON.paths[t])},this):RES.getResByUrl(u,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){e.call(r,generateJSON.paths[t])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var adapter;!function(t){var e=function(){function t(t,e,n){this.trackIndex=0,this.name="",this.loop=!1,this.trackIndex=t,this.name=e,this.loop=n}return t}();__reflect(e.prototype,"AnimationInfo");var n=function(n){function r(){var t=n.call(this)||this;return t.mArmature=null,t.mArmatureDisplay=null,t.mFactory=null,t.mState=null,t.mAutoDispose=!0,t.mSkinName="default",t.mHasSetAnimation=!1,t.mAniInfos=[],t.mTypeToResolveDict={},t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t._onRemove,t),t}return __extends(r,n),r.prototype.addAnimationStateListener=function(t){this.mStatListener=t,this._addDragonBoneEvent()},r.prototype.removeAnimationStateListener=function(t){this.mStatListener=null,this._removeDragonBoneEvent()},r.prototype._onRemove=function(){this.mAutoDispose,this._removeDragonBoneEvent()},r.prototype._addDragonBoneEvent=function(){var t=this;t.egretArmatureDisplay&&(t.egretArmatureDisplay.hasEventListener(dragonBones.EventObject.FRAME_EVENT)||t.egretArmatureDisplay.addEventListener(dragonBones.EventObject.FRAME_EVENT,t._animationEventHandler,t),t.egretArmatureDisplay.hasEventListener(dragonBones.EventObject.COMPLETE)||t.egretArmatureDisplay.addEventListener(dragonBones.EventObject.COMPLETE,t._animationEventHandler,t),t.egretArmatureDisplay.hasEventListener(dragonBones.EventObject.START)||t.egretArmatureDisplay.addEventListener(dragonBones.EventObject.START,t._animationEventHandler,t),t.egretArmatureDisplay.hasEventListener(dragonBones.EventObject.LOOP_COMPLETE)||t.egretArmatureDisplay.addEventListener(dragonBones.EventObject.LOOP_COMPLETE,t._animationEventHandler,t))},r.prototype._removeDragonBoneEvent=function(){var t=this;t.egretArmatureDisplay&&(t.egretArmatureDisplay.removeEventListener(dragonBones.EventObject.FRAME_EVENT,t._animationEventHandler,t),t.egretArmatureDisplay.removeEventListener(dragonBones.EventObject.COMPLETE,t._animationEventHandler,t),t.egretArmatureDisplay.removeEventListener(dragonBones.EventObject.START,t._animationEventHandler,t),t.egretArmatureDisplay.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE,t._animationEventHandler,t))},r.prototype._animationEventHandler=function(t){t&&this._resolveAll(t.type,t)},r.init=function(){t.Scheduler.frameCall(function(t){dragonBones.WorldClock.clock.advanceTime(t/1e3)},this,-1)},r.prototype.initWithName=function(t,e){return void 0===e&&(e=!0),__awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,this.initWithFile2(t+"_ske",t+"_tex",e)];case 1:return n.sent(),[2]}})})},r.prototype.initWithFile3=function(t,e,n,r,i,a,o){return void 0===a&&(a="default"),void 0===o&&(o=!0),__awaiter(this,void 0,void 0,function(){return __generator(this,function(s){switch(s.label){case 0:return[4,this.initWithFile2(t,e,o)];case 1:return s.sent(),this.setSkin(a),this.setAnimation(n,r,i),[2]}})})},r.prototype.initWithFile2=function(e,n,r){return void 0===r&&(r=!0),__awaiter(this,void 0,void 0,function(){var i,a,o,s,u,c,l;return __generator(this,function(h){switch(h.label){case 0:if(t.AssetsMgr.getRes(e+"_json")&&t.AssetsMgr.getRes(n+"_json")&&t.AssetsMgr.getRes(n+"_png"))return[3,2];i=!1;try{i=!!t.AssetsMgr.getGroupByName(e+"_db")}catch(d){}return i||t.AssetsMgr.createGroup(e+"_db",[e+"_json",n+"_json",n+"_png"]),[4,t.AssetsMgr.loadGroup(e+"_db")];case 1:h.sent(),h.label=2;case 2:for(a=t.AssetsMgr.getRes(e+"_json"),o=t.AssetsMgr.getRes(n+"_json"),s=t.AssetsMgr.getRes(n+"_png"),this.mFactory=new dragonBones.EgretFactory,this.mFactory.parseDragonBonesData(a),this.mFactory.parseTextureAtlasData(o,s),this.mArmatureDisplay=this.mFactory.buildArmatureDisplay(e.substr(0,e.indexOf("_ske"))),this.mAutoDispose=r,this.mArmature=this.mArmatureDisplay.armature,this.addChild(this.mArmatureDisplay),u=0,c=Object.keys(this.mTypeToResolveDict);u<c.length;u++)l=c[u],this._listenEvent(l);return this._addDragonBoneEvent(),this.setSkin(this.mSkinName),this.mAniInfos.length>0&&this.setAnimation(this.mAniInfos[0].trackIndex,this.mAniInfos[0].name,this.mAniInfos[0].loop),[2]}})})},Object.defineProperty(r.prototype,"armatureDisplay",{get:function(){return this.mArmatureDisplay},set:function(t){this.mArmatureDisplay=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isResLoaded",{get:function(){return this.mArmature?!0:!1},enumerable:!0,configurable:!0}),r.prototype.setTimeScale=function(t){var e=this;e.mArmature&&e.mArmature.animation&&(e.mArmature.animation.timeScale=t)},r.prototype.getAnimationNames=function(){for(var t=[],e=this.mAniInfos,n=0,r=e.length;r>n;n++)t.push(e[n].name);return t},r.prototype.setAnimation=function(t,n,r){if(!this.mArmature){this.mAniInfos=[];var i=new e(t,n,r);return this.mAniInfos.push(i),null}return this.mHasSetAnimation&&this.pause(),"boolean"==typeof r?this.mState=this.mArmature.animation.play(n,r?0:1):"number"==typeof r&&(this.mState=this.mArmature.animation.play(n,r)),this.mHasSetAnimation=!0,this.mState},r.prototype.addAnimation=function(e,n,r,i,a){return __awaiter(this,void 0,void 0,function(){var o,s;return __generator(this,function(u){switch(u.label){case 0:return[4,this.waitEvent(t.ArmatureAnimation.EVENT_COMPLETE)];case 1:return u.sent(),o=this,s=o.mArmature&&o.mArmature.animation?o.mArmature.animation.lastAnimationName:null,s==n&&(a&&this.setMix(r,a),this.setAnimation(e,r,i)),[2]}})})},Object.defineProperty(r.prototype,"lastAnimationName",{get:function(){var t=this.getCurrent();return t?t.lastAnimationName:null},enumerable:!0,configurable:!0}),r.prototype.setSkin=function(t){if(!t)return!1;if(t=t.trim(),""===t&&(t="default"),this.mSkinName=t,this.mFactory&&this.mArmature&&this.mArmature.armatureData){this.mArmature.armatureData.getSkin(t)}return!0},r.prototype.disableBatch=function(){var t=this;t.mArmature&&t.mArmature.display&&t.mArmature.display.disableBatch()},r.prototype.findBone=function(t){var e=this;return e.mArmature?e.mArmature.getBone(t):null},r.prototype.findSlot=function(t){var e=this;return e.mArmature?e.mArmature.getSlot(t):null},r.prototype.setMix=function(t,e,n){var r=this;return r.mArmature&&r.mArmature.animation?r.mArmature.animation.fadeIn(t,e,n):void 0},r.prototype.dispose=function(){this.mArmature&&(this.mArmature.dispose(),this.mArmature=null);for(var t=0,e=Object.keys(this.mTypeToResolveDict);t<e.length;t++){var n=e[t];this._resolveAll(n)}this.mTypeToResolveDict={}},r.prototype.waitEvent=function(t){var e=this;return new Promise(function(n,r){e.mTypeToResolveDict[t]||(e.mTypeToResolveDict[t]=[],e._listenEvent(t)),e.mTypeToResolveDict[t].push(n)})},Object.defineProperty(r.prototype,"egretArmatureDisplay",{get:function(){var t=this;return t.mArmature&&t.mArmature.display?t.mArmature.display:null},enumerable:!0,configurable:!0}),r.prototype._listenEvent=function(t){var e=this;t=this._isEventStringType(t)?t:r.FRAME_EVENT,this.mArmature&&(t==r.FRAME_EVENT&&this.egretArmatureDisplay.hasEventListener(r.FRAME_EVENT)||this.egretArmatureDisplay.addEventListener(t,function(n){e._resolveAll(t,n)},this))},r.prototype._resolveAll=function(t,e){var n=this,r=e&&e.eventObject?e.eventObject.name:null;if(n.mStatListener&&e){var i=e.eventObject&&e.eventObject.name?e.eventObject.name:e.type;n.mStatListener.event(e,i)}r&&""!=r.trim()&&n.mTypeToResolveDict[r]&&n._resolveByEventType(r,e),n._resolveByEventType(t,e)},r.prototype._resolveByEventType=function(t,e){if(this.mTypeToResolveDict[t]){for(var n=0,r=this.mTypeToResolveDict[t].length;r>n;n++)this.mTypeToResolveDict[t][n](e);this.mTypeToResolveDict[t]=void 0}},r.prototype._isEventStringType=function(t){var e=[dragonBones.EventObject.START,dragonBones.EventObject.LOOP_COMPLETE,dragonBones.EventObject.COMPLETE,dragonBones.EventObject.FADE_IN,dragonBones.EventObject.FADE_IN_COMPLETE,dragonBones.EventObject.FADE_OUT,dragonBones.EventObject.FADE_OUT_COMPLETE,dragonBones.EventObject.FRAME_EVENT,dragonBones.EventObject.SOUND_EVENT];return-1==e.indexOf(t)?!1:!0},r.prototype.cacheFrameRate=function(t){void 0===t&&(t=24),this.mArmature&&(this.mArmature.cacheFrameRate=t)},r.prototype.getCurrent=function(){return this.mArmature?this.mArmature.animation:null},r.prototype.pause=function(){this.mState&&this.mState.stop()},r.prototype.resume=function(){this.mState&&this.mState.play()},r.prototype.reset=function(){this.mArmature&&this.mArmature.animation&&this.mArmature.animation.reset()},r.EVENT_START=dragonBones.EventObject.START,r.EVENT_COMPLETE=dragonBones.EventObject.COMPLETE,r.FADE_IN=dragonBones.EventObject.FADE_IN,r.FADE_IN_COMPLETE=dragonBones.EventObject.FADE_IN_COMPLETE,r.FADE_OUT=dragonBones.EventObject.FADE_OUT,r.FADE_OUT_COMPLETE=dragonBones.EventObject.FADE_OUT_COMPLETE,r.LOOP_COMPLETE=dragonBones.EventObject.LOOP_COMPLETE,r.FRAME_EVENT=dragonBones.EventObject.FRAME_EVENT,r.SOUNT_EVENT=dragonBones.EventObject.SOUND_EVENT,r}(egret.DisplayObjectContainer);t.ArmatureAnimation=n,__reflect(n.prototype,"adapter.ArmatureAnimation")}(adapter||(adapter={}));var adapter;!function(t){var e=function(){function e(){}return e.loadConfig=function(t,e){return RES.loadConfig(t,e)},e.loadGroup=function(e,n,r){return RES.loadGroup(e,n,r)["catch"](function(e){t.Logger.error("AssetsMgr","loadGroup error : "+e.message)})},e.isGroupLoaded=function(t){return RES.isGroupLoaded(t)},e.getGroupByName=function(t){return RES.getGroupByName(t)},e.createGroup=function(t,e,n){return RES.createGroup(t,e,n)},e.hasRes=function(t){return RES.hasRes(t)},e.getRes=function(t){return RES.getRes(t)},e.getResAsync=function(e){return RES.getResAsync(e)["catch"](function(e){t.Logger.error("AssetsMgr","getResAsync error : "+e.message)})},e.getResByUrl=function(t,e,n,r){RES.getResByUrl(t,e,n,r)},e.destroyRes=function(t,e){return RES.destroyRes(t,e)},e.addEventListener=function(t,e,n,r,i){RES.addEventListener(t,e,n,r,i)},e.removeEventListener=function(t,e,n,r){RES.removeEventListener(t,e,n,r)},e.getResourceInfo=function(t){return RES.getResourceInfo(t)},e}();t.AssetsMgr=e,__reflect(e.prototype,"adapter.AssetsMgr")}(adapter||(adapter={}));var FRAME_TIME=30,test_root="http://h5.heniw.com/newyear2019/",normal_root="http://h5.heniw.com/newyear2019/",adapter;!function(t){var e=function(){function e(){}return e._playBtnAni=function(e){t.tween(e).wait(530).to({scaleX:1.15,scaleY:.85},3*FRAME_TIME).to({scaleX:.9,scaleY:1.1},3*FRAME_TIME).to({scaleX:1.05,scaleY:.95},3*FRAME_TIME).to({scaleX:.98,scaleY:1.02},3*FRAME_TIME).to({scaleX:1,scaleY:1},3*FRAME_TIME)},e.addClickAniForBtn=function(e,n,r){var i=this;void 0===n&&(n=1),void 0===r&&(r=1),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.tween(e).to({scaleX:.9*n,scaleY:.9*r},2*FRAME_TIME)},this),e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.tween(e).to({scaleX:1.05*n,scaleY:1.05*r},3*FRAME_TIME).to({scaleX:1*n,scaleY:1*r},4*FRAME_TIME)},this),e.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){t.tween(e).to({scaleX:1*n,scaleY:1*r},2*FRAME_TIME)},this),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(i){return t.tween(e).to({scaleX:1*n,scaleY:1*r},2*FRAME_TIME),[2]})})},this)},e.playBtnshakeAni=function(n){e._playBtnAni(n),e.mTimer[n.hashCode]=t.Scheduler.loopCall(2e3,function(){e._playBtnAni(n)},this,0)},e.stopBtnShakeAni=function(n){e.mTimer&&t.Scheduler.cancelTimeCall(e.mTimer[n.hashCode])},e.convertCoodinate=function(t,e,n,r){var i=t.localToGlobal(n,r);return e.globalToLocal(i.x,i.y)},e.generateMovieClip=function(e,n){void 0===n&&(n=e);var r=t.AssetsMgr.getRes(e+"_json"),i=t.AssetsMgr.getRes(e+"_png"),a=new egret.MovieClipDataFactory(r,i),o=new egret.MovieClip(a.generateMovieClipData(n));return o.name=e,o},e.createModalBg=function(t,e){var n=new egret.Shape;return n.graphics.beginFill(0),n.graphics.drawRect(0,0,t,e),n.graphics.endFill(),n.alpha=.7,n},e.moveNode2DestUA=function(e,n,r,i,a,o,s){var u=this;return new Promise(function(c,l){var h=e.x,d=e.y,p=0,f=(n-h)/i,m=2*(r-d-a*i)/(i*i),g=e.rotation,v=(o-g)/i,y=e.scaleX,E=(s-y)/i,_=t.Scheduler.frameCall(function(s){return p+=s/1e3,p>=i?(e.x=n,e.y=r,e.rotation=o,e.scaleX=e.scaleY=o,t.Scheduler.cancelFrameCall(_),void c()):(e.x=h+f*p,e.y=d+a*p+m*p*p/2,e.rotation=g+v*p,void(e.scaleX=e.scaleY=y+E*p))},u,-1)})},e.moveNode2DestAU=function(e,n,r,i,a,o,s){var u=this;return new Promise(function(c,l){var h=e.x,d=e.y,p=0,f=(r-d)/i,m=2*(n-h-a*i)/(i*i),g=e.rotation,v=(o-g)/i,y=e.scaleX,E=(s-y)/i,_=t.Scheduler.frameCall(function(u){return p+=u/1e3,p>=i?(e.x=n,e.y=r,e.rotation=o,e.scaleX=e.scaleY=s,t.Scheduler.cancelFrameCall(_),void c()):(e.x=h+a*p+m*p*p/2,e.y=d+f*p,e.rotation=g+v*p,void(e.scaleX=e.scaleY=y+E*p))},u,-1)})},e.moveNode2DestUU=function(e,n,r,i,a,o){var s=this;return new Promise(function(u,c){var l=0,h=e.x,d=(n-h)/i,p=e.y,f=(r-p)/i,m=e.rotation,g=(a-m)/i,v=e.scaleX,y=(o-v)/i,E=t.Scheduler.frameCall(function(s){return l+=s/1e3,l>=i?(e.x=n,e.y=r,e.rotation=a,e.scaleX=e.scaleY=o,t.Scheduler.cancelFrameCall(E),void u()):(e.x=h+d*l,e.y=p+f*l,e.rotation=m+g*l,void(e.scaleX=e.scaleY=v+y*l))},s,-1)})},e.mTimer={},e}();t.DisplayUtil=e,__reflect(e.prototype,"adapter.DisplayUtil")}(adapter||(adapter={}));var adapter;!function(t){var e=function(){function e(){this.listenersMap={}}return e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.addListener=function(n,r){if(!r)return void t.Logger.warn(e.LOG_TAG,"Add a null or undefined listener to the list!");var i=this.listenersMap[n];return i||(this.listenersMap[n]=new Array,i=this.listenersMap[n]),i.indexOf(r)>=0?void t.Logger.warn(e.LOG_TAG,"Add a exist listener to the list!"):void i.push(r)},e.prototype.removeListener=function(n,r){if(!r)return void t.Logger.warn(e.LOG_TAG,"Remove a null or undefined listener to the list!");var i=this.listenersMap[n];if(!i)return void t.Logger.warn(e.LOG_TAG,"Remove a listener from a list which is not exist!");var a=i.indexOf(r);return 0>a?void t.Logger.warn(e.LOG_TAG,"Remove a listener which is not exist in the list!"):void i.splice(a,1)},e.prototype.dispatch=function(n,r,i){void 0===i&&(i=null);var a=this.listenersMap[n];if(!a)return void t.Logger.warn(e.LOG_TAG,"Dispatch event failed, list is not exist!");for(var o=0,s=a.length;s>o;o++)a[o].handleEvent(n,r,i)},e.LOG_TAG="EventDispatcher",e._instance=null,e}();t.EventDispatcher=e,__reflect(e.prototype,"adapter.EventDispatcher")}(adapter||(adapter={}));var HttpManage=function(){function t(){}return t.prototype.sendHttpReq=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,n){var r=new egret.HttpRequest;r.responseType=egret.HttpResponseType.TEXT;var i=normal_root+t.path;t.method===egret.URLRequestMethod.GET&&t.data.trim()&&(i+="?"+t.data),r.open(i,t.method),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.addEventListener(egret.Event.COMPLETE,function(){e(r.response)},null),r.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){n(t)},null),egret.HttpMethod.POST===t.method?r.send(t.data):r.send()})]})})},t}();__reflect(HttpManage.prototype,"HttpManage");var adapter;!function(t){var e;!function(t){t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR"}(e=t.LogerLevel||(t.LogerLevel={}));var n=function(){function t(){}return t.debug=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];console.debug.apply(console,[t].concat(e))},t.info=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];console.info.apply(console,[t].concat(e))},t.warn=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];console.warn.apply(console,[t].concat(e))},t.error=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];console.error.apply(console,[t].concat(e))},t}();t.Logger=n,__reflect(n.prototype,"adapter.Logger")}(adapter||(adapter={}));var adapter;!function(t){var e=function(){function t(){}return t}();__reflect(e.prototype,"FrameCaller");var n=function(){function n(){}return n._timerCall=function(t,e,r,i){var a=new egret.Timer(t,i),o=n.timerId++;return n.timerDict[o]=a,1==i?a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(t){e.apply(r),n.timerDict[o]=void 0},this):(a.addEventListener(egret.TimerEvent.TIMER,e,r),a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(t){n.timerDict[o]=void 0},this)),a.start(),o},n.delayCall=function(e,r,i){return r?n._timerCall(e,r,i,1):(t.Logger.warn(n.LOG_TAG,"Delay call with a function undefined or null!"),-1)},n.loopCall=function(e,r,i,a){return r?n._timerCall(e,r,i,a):(t.Logger.warn(n.LOG_TAG,"Loop call with a function undefined or null!"),-1)},n.cancelTimeCall=function(e){return n.timerDict[e]?(n.timerDict[e].stop(),n.timerDict[e]=void 0,void delete n.timerDict[e]):void t.Logger.warn(n.LOG_TAG,"Cancel a time call which is not exist!")},n.cancelAllTimeCall=function(){for(var t in n.timerDict)n.timerDict[t].stop();n.timerDict={}},n._onEnterFrame=function(t){var e=Date.now(),r=e-n.lastFrameTime;n.lastFrameTime=e;var i=[],a=0;for(var o in n.frameCallerDict){a++;var s=n.frameCallerDict[o];s.obj?s.func.apply(s.obj,[r]):s.func(r),s.loopCount>0&&s.curLoop++,s.loopCount>0&&s.loopCount==s.curLoop&&i.push(o)}if(a==i.length)return void n.cancelAllFrameCall();for(var u=0,c=i.length;c>u;u++){var o=i[u];n.frameCallerDict[o]=void 0,delete n.frameCallerDict[o]}},n.frameCall=function(r,i,a){if(!r)return t.Logger.warn(n.LOG_TAG,"Frame call with a function undefined or null!"),-1;var o=new e;o.func=r,o.obj=i,o.loopCount=a,o.curLoop=0;var s=n.frameCallerId++;return n.frameCallerDict[s]=o,n.displayObj||(n.displayObj=new egret.DisplayObject),n.isListenToFrameEvent||(n.lastFrameTime=Date.now(),n.displayObj.addEventListener(egret.Event.ENTER_FRAME,this._onEnterFrame,this),n.isListenToFrameEvent=!0),s},n.waitForTime=function(t){return __awaiter(this,void 0,void 0,function(){var e,r=this;return __generator(this,function(i){return e=0,[2,new Promise(function(i,a){var o=n.frameCall(function(r){e+=r,e>=t&&(n.cancelFrameCall(o),i(e))},r,-1)})]})})},n.cancelFrameCall=function(e){return n.frameCallerDict[e]?(n.frameCallerDict[e]=void 0,void delete n.frameCallerDict[e]):void t.Logger.warn(n.LOG_TAG,"Cancel a frame call which is not exist!")},n.cancelAllFrameCall=function(){n.displayObj&&(n.displayObj.removeEventListener(egret.Event.ENTER_FRAME,this._onEnterFrame,this),n.isListenToFrameEvent=!1),n.frameCallerDict={}},n.LOG_TAG="Scheduler",n.timerId=1,n.timerDict={},n.frameCallerId=1,n.frameCallerDict={},n.displayObj=null,n.isListenToFrameEvent=!1,n.lastFrameTime=0,n.mSlowCount=0,n.mNormalCount=0,n.mFrameRate=0,n}();t.Scheduler=n,__reflect(n.prototype,"adapter.Scheduler")}(adapter||(adapter={}));var adapter;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.stop=function(){},e}(egret.EventDispatcher);__reflect(e.prototype,"NullSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"]);var n=function(){function n(){}return Object.defineProperty(n,"isMusicPlaying",{get:function(){return null!=this.mMusicChannel},enumerable:!0,configurable:!0}),Object.defineProperty(n,"soundEnabled",{get:function(){return this.mSoundEnabled},set:function(t){t||this.stopAllSound(),this.mSoundEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(n,"musicEnabled",{get:function(){return this.mMusicEnabled},set:function(t){this.mMusicEnabled=t,t?(this.mMusicDuration=0,this.resumeMusic()):this.pauseMusic()},enumerable:!0,configurable:!0}),Object.defineProperty(n,"soundVolume",{get:function(){return this.mSoundVolume},set:function(t){this.mSoundVolume=t},enumerable:!0,configurable:!0}),Object.defineProperty(n,"musicVolume",{get:function(){return this.mMusicVolume},set:function(t){this.mMusicChannel&&(this.mMusicChannel.volume=t),this.mMusicVolume=t},enumerable:!0,configurable:!0}),n.playSound=function(e,n,r){void 0===n&&(n=1),void 0===r&&(r=0);var i;if(this.mSoundEnabled){var a=t.AssetsMgr.getRes(e.replace(/\./g,"_"));(i=a?a.play(r,n):null)&&(this.mSoundChannels.push(i),i.volume=this.mSoundVolume,i.once(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this))}return i||this.mNullSoundChannel},n.playSoundAsync=function(e,n,r){var i=this;return void 0===n&&(n=1),void 0===r&&(r=0),this.mSoundEnabled?(e=e.replace(/\./g,"_"),t.AssetsMgr.getResAsync(e).then(function(){return i.playSound(e,n,r)})):Promise.resolve(this.mNullSoundChannel)},n.onSoundComplete=function(t){var e=this.mSoundChannels.indexOf(t.target);-1!=e&&this.mSoundChannels.splice(e,1)},n.delSound=function(t){var e=this.mSoundChannels.indexOf(t);-1!=e&&this.mSoundChannels.splice(e,1)},n.playMusic=function(e){var n;if(this.mMusicEnabled){var r=t.AssetsMgr.getRes(e.replace(/\./g,"_"));this.mMusicChannel&&this.mMusicChannel.stop(),(n=r?r.play():null)&&(n.volume=this.mMusicVolume,this.mMusicChannel=n,this.mMusicRes=r)}return n||this.mNullSoundChannel},n.playMusicAsync=function(e){var n=this;return this.mMusicEnabled?(e=e.replace(/\./g,"_"),t.AssetsMgr.getResAsync(e).then(function(){return n.playMusic(e)})):Promise.resolve(this.mNullSoundChannel)},n.stopMusic=function(){this.mMusicChannel&&(this.mMusicChannel.stop(),this.mMusicChannel=null,this.mMusicRes=null)},n.pauseMusic=function(){this.mMusicChannel&&(this.mMusicDuration=this.mMusicChannel.position,this.mMusicChannel.stop(),this.mMusicChannel=null)},n.resumeMusic=function(){this.mMusicEnabled&&this.mMusicRes&&!this.mMusicChannel&&(this.mMusicChannel=this.mMusicRes.play(this.mMusicDuration),this.mMusicChannel.volume=this.mMusicVolume)},n.stopAllSound=function(){for(var t=0,e=this.mSoundChannels;t<e.length;t++){var n=e[t];n.stop()}this.mSoundChannels.length=0},n.mMusicEnabled=!0,n.mSoundEnabled=!0,n.mMusicVolume=1,n.mSoundVolume=1,n.mMusicDuration=0,n.mMusicRes=null,n.mMusicChannel=null,n.mSoundChannels=[],n.mNullSoundChannel=new e,n}();t.SoundManager=n,__reflect(n.prototype,"adapter.SoundManager")}(adapter||(adapter={}));var adapter;!function(t){var e=function(){function t(){this.contentGroup=[],this.tipsGroup=[],this.alertGroup=[]}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.init=function(t,e){this.container=t,this.contentLayer=new egret.DisplayObjectContainer,this.contentLayer.x=e.x,this.contentLayer.y=e.y,this.contentLayer.width=e.width,this.contentLayer.height=e.height,this.container.addChild(this.contentLayer),this.tipsLayer=new egret.DisplayObjectContainer,this.tipsLayer.x=e.x,this.tipsLayer.y=e.y,this.tipsLayer.width=e.width,this.tipsLayer.height=e.height,this.container.addChild(this.tipsLayer),this.alertLayer=new egret.DisplayObjectContainer,this.alertLayer.x=e.x,this.alertLayer.y=e.y,this.alertLayer.width=e.width,this.alertLayer.height=e.height,this.container.addChild(this.alertLayer)
},Object.defineProperty(t.prototype,"width",{get:function(){return this.contentLayer.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.contentLayer.height},enumerable:!0,configurable:!0}),t.prototype.addView=function(t,e){void 0===e&&(e=0),t.height=this.height,t.width=this.width,t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=.5*this.width,t.y=.5*this.height,this.addViewToLayer(t,e)},t.prototype.removeView=function(t,e){void 0===e&&(e=0),this.removeViewForLayer(t,e)},t.prototype.addViewToLayer=function(t,e){switch(e){case 0:this.contentGroup.push(t),this.contentLayer.addChild(t);break;case 1:this.tipsGroup.push(t),this.tipsLayer.addChild(t);break;case 2:this.alertGroup.push(t),this.alertLayer.addChild(t)}},t.prototype.removeViewForLayer=function(t,e){var n=null,r=null;switch(e){case 0:n=this.contentGroup,r=this.contentLayer;break;case 1:n=this.tipsGroup,r=this.tipsLayer;break;case 2:n=this.alertGroup,r=this.alertLayer}var i=n.indexOf(t);i>=0&&n.slice(i,1);var a=r.getChildIndex(t);a>=0&&r.removeChildAt(a)},t._instance=null,t}();t.UIWindow=e,__reflect(e.prototype,"adapter.UIWindow")}(adapter||(adapter={}));var adapter;!function(t){var e=function(){function e(){}return e.isArray=function(t){return"object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t)},e.isObject=function(t){return"object"==typeof t&&"[object Array]"!==Object.prototype.toString.call(t)},e.isString=function(t){return"string"==typeof t||"[object String]"==Object.prototype.toString.call(t)},e.isFunction=function(t){return"[object Function]"===Object.prototype.toString.call(t)},e.isRealNum=function(t){return""===t||null==t?!1:isNaN(t)?!1:!0},e.getMovieClip=function(e,n,r){var i=t.AssetsMgr.getRes(e),a=t.AssetsMgr.getRes(n),o=new egret.MovieClipDataFactory(i,a),s=new egret.MovieClip(o.generateMovieClipData(r));return s},e.formatNumberWithSplit=function(t){var e=~~t;if(isNaN(e))return"";var n=e+"",r=n.length,i="";if(r>3){var a,o=Math.ceil(r/3)-1;a=r%3==0?3:r%3,i=n.substring(0,a);for(var s=0;o>s;s++)i+=","+n.substring(a+3*s,a+3*(s+1))}else i=n;return i},e.random=function(t,e){if(t==e)return t;var n=e>t?t:e,r=t>e?t:e;return n+Math.floor(Math.random()*(r-n))},e.getRandomWeightIndex=function(t){if(0===t.length)return-1;if(1===t.length)return 0;var n=e.getArrSum(t);if(!n)return-1;for(var r=e.random(1,n+1),i=0,a=0,o=0;o<t.length;o++){if(a+=t[o],r>=i&&a>=r)return o;i=a}return-1},e.getArrSum=function(t){for(var n=0,r=0;r<t.length;r++){var i=t[r];if(!e.isRealNum(i))return null;n+=i}return n},e.secondsToDHMS=function(t){t=Math.max(0,t);var e=Math.floor(t%60),n=Math.floor(t/60)%60,r=Math.floor(t/3600)%24,i=Math.floor(t/86400);return{day:i,hour:r,min:n,sec:e}},e.formatTimeDHMS=function(t){var e=t.day,n=t.hour,r=t.min,i=t.sec;return{day:""+e,hour:10>n?"0"+n:""+n,min:10>r?"0"+r:""+r,sec:10>i?"0"+i:""+i}},e.formatDate=function(t){var e=new Date(t),n=e.getFullYear()+"-",r=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",i=e.getDate()<10?"0"+e.getDate():e.getDate();return n+r+i},e.formatDateNo_=function(t){var e=new Date(t),n=e.getFullYear()+"",r=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"",i=e.getDate()<10?"0"+e.getDate():e.getDate();return Number(n+r+i)},e.getCurTime=function(){return(new Date).toLocaleTimeString()},e.getRemainTimeArr=function(t){var e=[],n=Math.floor(t/86400),r=Math.floor(t%86400/3600),i=Math.floor(t%86400%3600/60),a=Math.floor(t%86400%3600%60);return e=[n,r,i,a]},e.formatTimeHMS=function(t){t=Math.max(0,t);var e=Math.floor(t%60),n=Math.floor(t/60)%60,r=Math.floor(t/3600);return(10>r?"0"+r:""+r)+":"+(10>n?"0"+n:""+n)+":"+(10>e?"0"+e:""+e)},e.formatTimeHM=function(t){t=Math.max(0,t);var e=Math.floor(t/60)%60,n=Math.floor(t/3600);return(10>n?"0"+n:""+n)+":"+(10>e?"0"+e:""+e)},e.formatTimeMS=function(t){t=Math.max(0,t);var e=Math.floor(t%60),n=Math.floor(t/60);return(10>n?"0"+n:""+n)+":"+(10>e?"0"+e:""+e)},e.setGrey=function(t){if(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],n=new egret.ColorMatrixFilter(e);t.filters=[n]}},e.canceGrey=function(t){t&&t.filters&&(t.filters.length=0)},e.formatBigNumber=function(t,e){void 0===e&&(e=0);var n=t+"",r=n.length,i="",a="";if(r>=13)t/=1e12,a="T";else if(r>=10)t/=1e9,a="B";else if(r>=7)t/=1e6,a="M";else if(r>=5)t/=1e4,a="W";else{if(!(r>=4))return this.formatNumberWithSplit(t);t/=1e3,a="K"}return i=e>=0?t.toFixed(e):Math.floor(100*t)/100+"",parseFloat(i)+a},e.formatBigNumberZh_cn=function(t,e){void 0===e&&(e=0);var n=t+"",r=n.length,i="",a="";if(r>=13)t/=1e12,a="T";else if(r>=10)t/=1e9,a="B";else if(r>=7)t/=1e6,a="M";else if(r>=5)t/=1e4,a="万";else{if(!(r>=4))return this.formatNumberWithSplit(t);t/=1e3,a="K"}return i=e>=0?t.toFixed(e):Math.floor(100*t)/100+"",parseFloat(i)+a},e.removeFromParent=function(t){t&&t.parent&&t.parent.removeChild(t)},e.getUrlParams=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=location&&location.search&&location.search.substr(1).match(e);return n&&n.length>=2?decodeURIComponent(n[2]):null},e.getObjFromParams=function(t){if(!t||""===t)return{};for(var e=t.split("&"),n={},r=0;r<e.length;r++){var i=e[r].split("=");n[i[0]]=i[1]}return n},e.randomPick=function(t){return t[~~(Math.random()*t.length)]||null},e.getBezier=function(t,e,n){return function(r){var i=1-(r=Math.min(1,r));return{x:i*i*t.x+2*r*i*e.x+r*r*n.x,y:i*i*t.y+2*r*i*e.y+r*r*n.y}}},e.bezierTo=function(e,n,r,i){return t.tween({time:0}).to({time:n},n,i).onChange(function(t){var i=r(t.time/n);e.x=i.x,e.y=i.y})},e.LoadJS=function(t){var e=document.getElementsByTagName("HEAD").item(0),n=document.createElement("SCRIPT");n.src=t,n.type="text/javascript",e.appendChild(n)},e.getCurrFullDate=function(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();return e+"-"+n+"-"+r},e.deepCloneObj=function(t){var n={};t instanceof Array&&(n=[]);for(var r in t){var i=t[r];n[r]="object"==typeof i?e.deepCloneObj(i):i}return n},e.intersectArea=function(t,e,n,r,i,a){var o,s,u,c,l;return c=Math.sqrt((r-t)*(r-t)+(i-e)*(i-e)),c>=n+a?l=0:c<=Math.abs(n-a)?l=a>=n?Math.PI*n*n:Math.PI*a*a:(u=(c+n+a)/2,o=2*Math.sqrt(u*(u-c)*(u-n)*(u-a)),n>a&&(s=t,t=r,r=s,s=e,e=i,i=s,s=n,n=a,a=s),l=Math.acos((n*n+c*c-a*a)/(2*n*c))*n*n+Math.acos((a*a+c*c-n*n)/(2*a*c))*a*a-o),l},e.IsPC=function(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,r=0;r<e.length;r++)if(t.indexOf(e[r])>0){n=!1;break}return n},e.copy=function(t){},e.getStringLength=function(t){for(var e=0,n=0;e<t.length;){var r=t.charCodeAt(e);r>255?n+=2:n++,e++}return n},e.subString=function(t,e){for(var n=0,r=0,i="";n<t.length&&e>r;){var a=t.charCodeAt(n);a>255?r+=2:r++,i+=t.charAt(n),n++}return i},e}();t.Util=e,__reflect(e.prototype,"adapter.Util")}(adapter||(adapter={}));var GameMainController=function(){function t(){this.curGridId=50,this.gridDataArr=[],this.giftListData=[]}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.showMainView=function(){adapter.UIWindow.getInstance().addView(new GameMainSceneView),this.isShowRulePop()&&this.showRulePopView()},t.prototype.showRulePopView=function(){adapter.UIWindow.getInstance().addView(new RulePopView,1)},t.prototype.showGiftPopView=function(){adapter.UIWindow.getInstance().addView(new GiftPopView)},t.prototype.showCardGiftView=function(t){adapter.UIWindow.getInstance().addView(new CardGiftView(t))},t.prototype.showTickGiftView=function(t){adapter.UIWindow.getInstance().addView(new TicketGiftView(t))},t.prototype.showInputView=function(t){adapter.UIWindow.getInstance().addView(new InputPopView(t))},t.prototype.showGiftListView=function(){GameMainHttpManage.getGiftList().then(function(){adapter.UIWindow.getInstance().addView(new GiftListView)})},t.prototype.isShowRulePop=function(){var t=egret.localStorage.getItem("alreadyShowRuelPop");return!t},t.prototype.initGridData=function(){var t=RES.getRes("grid_json");for(var e in t)t.hasOwnProperty(e)&&(this.gridDataArr[e]=new GridDataCell(t[e]))},t.prototype.getPathArr=function(t,e){for(var n=[],r=0;e>r;++r){var i=t-1;0>i&&(i=this.gridDataArr.length-1),n.push(i),t=i}return n},t.prototype.getCardGift=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,GameMainHttpManage.getCardData()];case 1:return t=e.sent(),GameMainHttpManage.exchangeGift({userGiftId:t.data.userGiftId}),[2]}})})},t._instance=null,t}();__reflect(GameMainController.prototype,"GameMainController");var GameMainHttpManage=function(){function t(){}return t.requestStartGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,service.get("/game/start")];case 1:return t=e.sent(),200===t.status?(GameMainController.getInstance().gameId=t.data.id,[2,!0]):(1005===t.status?alert("游戏当前次数已用尽"):alert("当前系统发生故障"),[2,!1])}})})},t.requestEndGame=function(t){return void 0===t&&(t=0),__awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(r){switch(r.label){case 0:return e={id:GameMainController.getInstance().gameId,isAdd:t,mark:GameMainController.getInstance().curGridId+""},[4,service.get("/game/end",e)];case 1:return n=r.sent(),200===n.status?[2,!0]:(alert("游戏结束接口出错"),[2,!1])}})})},t.getGift=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n;return __generator(this,function(r){switch(r.label){case 0:return t={id:GameMainController.getInstance().gameId},[4,service.get("/gift/lottery",t)];case 1:return e=r.sent(),200===e.status?(n={type:e.data.giftInfo.type,msg:null},1===n.type?n.msg=e.data.userGiftId:n.msg=e.data.giftInfo.giftId,[2,n]):(2003===e.status?alert("谢谢参与"):alert("游戏结束接口出错"),[2,null])}})})},t.getGiftList=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n,r,i;return __generator(this,function(a){switch(a.label){case 0:return[4,service.get("/gift/list")];case 1:if(t=a.sent(),200===t.status){for(e=t.data.list,n=[],r=0,i=e.length;i>r;++r)n.push(new GiftListDataCell(e[r]));GameMainController.getInstance().giftListData=n,adapter.EventDispatcher.getInstance().dispatch(0,null)}else console.error("用户奖品列表接口出错");return[2]}})})},t.exchangeGift=function(t){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(r){switch(r.label){case 0:return e={name:t.name,mobile:t.phone,email:t.mail,userGiftId:t.userGiftId},[4,service.get("/gift/success",e)];case 1:return n=r.sent(),200===n.status?[2,!0]:(alert("兑换奖品接口出错"),[2,!1])}})})},t.getCardData=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,service.get("/gift/get")];case 1:return t=e.sent(),200===t.status?[2,t]:(alert("获取卡卷数据接口出错"),[2,null])}})})},t}();__reflect(GameMainHttpManage.prototype,"GameMainHttpManage");var GiftListDataCell=function(){function t(t){this.userGiftId=t.userGiftId,this.imgIcon=t.image,this.desc=t.name,this.timeText=t.addTime.split(" ")[0],this.giftType=t.type,this.timeText=t.userGiftId,this.status=t.status}return t}();__reflect(GiftListDataCell.prototype,"GiftListDataCell");var TickeViewData=function(){function t(t){this.imgPath=t.giftInfo.image,this.userGiftId=t.userGiftId,this.desc=t.giftInfo.name}return t}();__reflect(TickeViewData.prototype,"TickeViewData");var GridDataCell=function(){function t(t){this.gridId=t.gridId,this.posX=adapter.UIWindow.getInstance().width*t.posX/540,this.posY=t.posY,this.gridEvent=t.gridEvent?t.gridEvent:0,this.extra=t.extra?t.extra:0}return t}();__reflect(GridDataCell.prototype,"GridDataCell");var CardGiftView=function(t){function e(e){var n=t.call(this)||this;return n.cardId=e,n.skinName="CardGift",n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){adapter.DisplayUtil.addClickAniForBtn(this.handleBtn),this.initView(),this.addEvent()},e.prototype.addEvent=function(){this.handleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeViewHandle,this)},e.prototype.initView=function(){this.cardIcon.source="other_5"+this.cardId+"_png"},e.prototype.closeViewHandle=function(){adapter.UIWindow.getInstance().removeView(this)},e}(eui.Component);__reflect(CardGiftView.prototype,"CardGiftView");var GameMainSceneView=function(t){function e(){var e=t.call(this)||this;return e.ani=null,e.groupArr=null,e.skinName="MainScene",e}return __extends(e,t),Object.defineProperty(e.prototype,"curGridId",{get:function(){return GameMainController.getInstance().curGridId},set:function(t){GameMainController.getInstance().curGridId=t},enumerable:!0,configurable:!0}),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){this.initData(),this.initView(),this.addEvent()},e.prototype.addEvent=function(){this.addSomeEvent(),adapter.EventDispatcher.getInstance().addListener(0,this)},e.prototype.removeEvent=function(){adapter.EventDispatcher.getInstance().removeListener(0,this)},e.prototype.handleEvent=function(t,e,n){switch(t){case 0:this.listCount.text="X"+GameMainController.getInstance().giftListData.length}},e.prototype.initData=function(){GameMainController.getInstance().initGridData(),this.groupArr=[this.childBgGroup1,this.childBgGroup2]},e.prototype.initView=function(){this.initStaticView(),this.initBg(),this.setStateView()},e.prototype.initStaticView=function(){this.diceGroup.visible=!1,adapter.DisplayUtil.addClickAniForBtn(this.playDiceBtn,.8,.8)},e.prototype.initBg=function(){this.setGroupPos(),this.addImgToGroup(this.childBgGroup1),this.addImgToGroup(this.childBgGroup2),this.addGiftBoxToGroup(this.childBgGroup1),this.addGiftBoxToGroup(this.childBgGroup2)},e.prototype.setStateView=function(){this.testBgGroup(),this.setBoat()},e.prototype.setGroupPos=function(){for(var t=0,e=0,n=this.groupArr.length;n>e;++e){var r=this.groupArr[e];r.y=t,t+=r.height}this.bgGroup.height=t},e.prototype.addImgToGroup=function(t){for(var e=[1030,1030,1268,1025],n=0,r=0;4>r;++r){var i=new eui.Image("mainBg_"+(r+1)+"_png");i.y=n,i.left=0,i.right=0,t.addChild(i),n+=e[r]}},e.prototype.addGiftBoxToGroup=function(t){for(var e=GameMainController.getInstance().gridDataArr,n=0,r=e.length;r>n;++n){var i=e[n];if(3===i.gridEvent){var a=new eui.Image("other_13_png");a.x=i.posX,a.y=i.posY,a.width=a.height=50,a.anchorOffsetX=a.anchorOffsetY=.5*a.width,t.addChild(a)}}},e.prototype.testBgGroup=function(){var t=this.getGridPos(this.curGridId).y,e=.5*adapter.UIWindow.getInstance().height;if(this.bgGroup.y=-(t-e),200>t-e){var n=-this.bgGroup.y;this.groupArr.push(this.groupArr.pop()),this.setGroupPos(),this.bgGroup.y=-(n+this.groupArr[0].height)}},e.prototype.setBoat=function(){this.boat.x=GameMainController.getInstance().gridDataArr[this.curGridId].posX,this.boat.y=.5*adapter.UIWindow.getInstance().height,this.setBoatDiect()},e.prototype.setBoatDiect=function(){var t=this.curGridId,e=GameMainController.getInstance().gridDataArr,n=t-1;0>n&&(n=e.length-1),this.boat.scaleX=this.getGridPos(t).x<this.getGridPos(n).x?1:-1},e.prototype.boatMove=function(t){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(r){switch(r.label){case 0:t.unshift(this.curGridId),e=1,n=t.length,r.label=1;case 1:return n>e?[4,this.boatMoveOneCell(t[e-1],t[e])]:[3,4];case 2:r.sent(),this.curGridId=t[e],this.setBoatDiect(),r.label=3;case 3:return++e,[3,1];case 4:return this.testBgGroup(),this.triggerEventHandle(),[2]}})})},e.prototype.boatMoveOneCell=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,r,i;return __generator(this,function(a){switch(a.label){case 0:return n=this.getGridPos(t),r=this.getGridPos(e),e>t&&(i=-(4353-r.y),r=new egret.Point(r.x,i)),adapter.tween(this.boat).by({x:r.x-n.x},500),adapter.tween(this.bgGroup).by({y:-(r.y-n.y)},500),[4,adapter.Scheduler.waitForTime(500)];case 1:return a.sent(),[2]}})})},e.prototype.clickBtnHandle=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return this.cancelEvent(),t=GameMainController.getInstance().getPathArr(this.curGridId,adapter.Util.random(1,7)),this.excutePlayCycle(t),[2]})})},e.prototype.triggerEventHandle=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n,r,i;return __generator(this,function(a){switch(a.label){case 0:switch(t=GameMainController.getInstance(),e=t.gridDataArr[this.curGridId].gridEvent,1!==e&&GameMainHttpManage.requestEndGame(2===e?1:0),n=e){case 1:return[3,1];case 2:return[3,3];case 3:return[3,5]}return[3,6];case 1:return[4,adapter.Scheduler.waitForTime(1e3)];case 2:return a.sent(),r=t.gridDataArr[this.curGridId].extra,i=t.getPathArr(this.curGridId,r),this.boatMove(i),[3,7];case 3:return[4,adapter.Scheduler.waitForTime(1e3)];case 4:return a.sent(),this.clickBtnHandle(),[3,7];case 5:return this.addSomeEvent(),[3,7];case 6:return this.addSomeEvent(),[3,7];case 7:return[2]}})})},e.prototype.excutePlayCycle=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.showGridAni(t.length)];case 1:return e.sent(),[4,adapter.Scheduler.waitForTime(100)];case 2:return e.sent(),[4,this.boatMove(t)];case 3:return e.sent(),[2]}})})},e.prototype.showGridAni=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){switch(n.label){case 0:return e=this.ani,this.ani?[3,2]:(e=this.ani=new adapter.ArmatureAnimation,[4,e.initWithName("ss1")]);case 1:n.sent(),e.x=.5*this.width,e.y=.5*this.height+150,n.label=2;case 2:return this.diceGroup.visible=!0,this.diceGroup.addChild(e),e.setAnimation(0,t+"",1),[4,e.waitEvent(adapter.ArmatureAnimation.EVENT_COMPLETE)];case 3:return n.sent(),[4,adapter.Scheduler.waitForTime(350)];case 4:return n.sent(),this.diceGroup.removeChild(e),this.diceGroup.visible=!1,[2]}})})},e.prototype.addSomeEvent=function(){this.playDiceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtnHandle,this),this.ruleIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showRulePop,this),this.listGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showGiftListView,this)},e.prototype.cancelEvent=function(){this.playDiceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtnHandle,this),this.ruleIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showRulePop,this),this.listGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showGiftListView,this)},e.prototype.showRulePop=function(){GameMainController.getInstance().showRulePopView()},e.prototype.showGiftListView=function(){GameMainController.getInstance().showGiftListView()},e.prototype.getOtherGroup=function(t){return t===this.childBgGroup1?this.childBgGroup2:this.childBgGroup1},e.prototype.getGridPos=function(t){var e=GameMainController.getInstance().gridDataArr[t];return new egret.Point(e.posX,e.posY)},e}(eui.Component);__reflect(GameMainSceneView.prototype,"GameMainSceneView",["adapter.EventListener"]);var GiftListView=function(t){function e(){var e=t.call(this)||this;return e.arrayCollection=new eui.ArrayCollection,e.skinName="GiftList",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){adapter.DisplayUtil.addClickAniForBtn(this.backBtn),this.initView(),this.addEvent()},e.prototype.addEvent=function(){this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeViewHandle,this),adapter.EventDispatcher.getInstance().addListener(1,this)},e.prototype.removeEvent=function(){adapter.EventDispatcher.getInstance().removeListener(1,this)},e.prototype.handleEvent=function(t,e,n){switch(t){case 1:this.closeViewHandle()}},e.prototype.initView=function(){this.contentList.itemRenderer=GiftListItemView,this.contentList.dataProvider=this.arrayCollection,this.arrayCollection.source=GameMainController.getInstance().giftListData},e.prototype.closeViewHandle=function(){this.removeEvent(),adapter.UIWindow.getInstance().removeView(this)},e}(eui.Component);__reflect(GiftListView.prototype,"GiftListView",["adapter.EventListener"]);var GiftListItemView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GiftListItem",e}return __extends(e,t),e.prototype.addEvent=function(){adapter.DisplayUtil.addClickAniForBtn(this.getBtn,.8,.8),this.getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getBtnHandle,this)},e.prototype.dataChanged=function(){var e=this;t.prototype.dataChanged.call(this);var n=this.data;RES.getResByUrl(n.imgIcon).then(function(t){e.iconImg.source=t}),this.desc.text=n.desc,this.timeText.text=n.timeText,this.getBtn.source=0===n.status?"other_22_png":"other_29_png"},e.prototype.getBtnHandle=function(){var t=this.data;if(0!==t.status)return void alert("此奖品已领取");switch(t.giftType){case 2:GameMainController.getInstance().getCardGift();break;case 1:GameMainController.getInstance().showInputView(t.userGiftId)}adapter.EventDispatcher.getInstance().dispatch(1,null)},e}(eui.ItemRenderer);__reflect(GiftListItemView.prototype,"GiftListItemView");var GiftPopView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GiftPop",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){adapter.DisplayUtil.addClickAniForBtn(this.openBtn),this.initView(),this.addEvent()},e.prototype.addEvent=function(){this.openBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openwHandle,this)},e.prototype.initView=function(){},e.prototype.openwHandle=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return[4,GameMainHttpManage.getGift()];case 1:switch(t=n.sent(),e=t.type){case 2:GameMainController.getInstance().showCardGiftView(t.msg);break;case 1:GameMainController.getInstance().showTickGiftView(t.msg)}return this.closeView(),[2]}})})},e.prototype.closeView=function(){adapter.UIWindow.getInstance().removeView(this)},e}(eui.Component);__reflect(GiftPopView.prototype,"GiftPopView");var InputPopView=function(t){function e(e){var n=t.call(this)||this;return n.userGiftId=e,n.skinName="InputViewSkin",n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){adapter.DisplayUtil.addClickAniForBtn(this.backBtn),adapter.DisplayUtil.addClickAniForBtn(this.handleBtn),this.initView(),this.addEvent()},e.prototype.addEvent=function(){this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeViewHandle,this),this.handleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitHandle,this)},e.prototype.initView=function(){},e.prototype.submitHandle=function(){var t={name:this.nameInput.text,phone:this.phoneInput.text,mail:this.mailInput.text,userGiftId:this.userGiftId};return t.name&&t.phone&&t.mail?(GameMainHttpManage.exchangeGift(t),void this.closeViewHandle()):void alert("提交信息不全！")},e.prototype.closeViewHandle=function(){adapter.UIWindow.getInstance().removeView(this)},e}(eui.Component);__reflect(InputPopView.prototype,"InputPopView");var RulePopView=function(t){function e(){var e=t.call(this)||this;return e.skinName="RulePop",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){egret.localStorage.setItem("alreadyShowRuelPop","1"),adapter.DisplayUtil.addClickAniForBtn(this.closeBtn),this.initView(),this.addEvent()},e.prototype.addEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeViewHandle,this)},e.prototype.initView=function(){for(var t=["让他看见我突然jerk他微软条件为看见他渴望我让他问题","让他看见我突然jerk他微软条件为看见他渴望我让他问题","让他看见我突然jerk他微软条件为看见他渴望我让他问题","让他看见我突然jerk他微软条件为看见他渴望我让他问题","让他看见我突然jerk他微软条件为看见他渴望我让他问题","让他看见我突然jerk他微软条件为看见他渴望我让他问题"],e=0,n=t.length;n>e;++e){var r=new eui.Label(t[e]);r.size=26,r.width=400,this.textGroup.addChild(r)}},e.prototype.closeViewHandle=function(){adapter.UIWindow.getInstance().removeView(this,1)},e}(eui.Component);__reflect(RulePopView.prototype,"RulePopView");var TicketGiftView=function(t){function e(e){var n=t.call(this)||this;return n.userGiftId=e,n.skinName="TicketGift",n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){adapter.DisplayUtil.addClickAniForBtn(this.handleBtn),this.initView(),this.addEvent()},e.prototype.addEvent=function(){this.handleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.handleBtnHandle,this)},e.prototype.initView=function(){},e.prototype.handleBtnHandle=function(){GameMainController.getInstance().showInputView(this.userGiftId),adapter.UIWindow.getInstance().removeView(this)},e}(eui.Component);__reflect(TicketGiftView.prototype,"TicketGiftView");var service;!function(t){function e(t,e){var n=s;if("object"==typeof e&&Object.keys(e).length>0)for(var r in e)n[r]=e[r];return cm.service.get(o+t,n)}function n(t,e){return cm.service.post(o+t,e)}function r(t){return cm.service.get(o+"/event/do",__assign({act:t,uid:localStorage.getItem("uid")},s))}var i;!function(t){t[t.ENTER=1]="ENTER",t[t.START=2]="START",t[t.LOTTERY=3]="LOTTERY",t[t.ADD_COUNT=4]="ADD_COUNT",t[t.SHARE=5]="SHARE"}(i=t.ACT_TYPE||(t.ACT_TYPE={}));var a=location.hostname.indexOf("0.0.0.0")>-1||location.hostname.indexOf("192")>-1||location.hostname.indexOf("localhost")>-1,o=a?"http://192.168.101.16:8888":"http://h5.heniw.com/newyear2019/",s=a?{ticket:encodeURIComponent("NbOy46uJDZpyMRoLSsPJ7JTS9j5XF6yFzJEl/K1Z9Bx10xFDqg")}:{};t.get=e,t.post=n,t.pushEvent=r}(service||(service={}));